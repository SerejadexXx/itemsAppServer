{"version":3,"sources":["../../../../source/lib/style/classes/fill.js"],"names":[],"mappings":"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","file":"fill.js","sourcesContent":["const utils = require('../../utils.js');\nconst types = require('../../types/index.js');\nconst _ = require('lodash');\nconst xmlbuilder = require('xmlbuilder');\nconst CTColor = require('./ctColor.js');\n\nclass Stop { //ยง18.8.38\n    /** \n     * @class Stop\n     * @desc Stops for Gradient fills\n     * @param {Object} opts Options for Stop\n     * @param {String} opts.color Color of Stop\n     * @param {Number} opts.position Order of Stop with first stop being 0\n     * @returns {Stop}\n     */\n    constructor(opts, position) {\n        this.color = new CTColor(opts.color);\n        this.position = position;\n    }\n\n    /** \n     * @func Stop.toObject\n     * @desc Converts the Stop instance to a javascript object\n     * @returns {Object}\n     */\n    toObject() {\n        let obj = {};\n        this.color !== undefined ? obj.color = this.color.toObject() : null;\n        this.position !== undefined ? obj.position = this.position : null;\n        return obj;\n    }\n}\n\nclass Fill { //ยง18.8.20 fill (Fill)\n\n    /** \n     * @class Fill\n     * @desc Excel Fill \n     * @param {Object} opts\n     * @param {String} opts.type Type of Excel fill (gradient or pattern)\n     * @param {Number} opts.bottom If Gradient fill, the position of the bottom edge of the inner rectange as a percentage in decimal form. (must be between 0 and 1)\n     * @param {Number} opts.top If Gradient fill, the position of the top edge of the inner rectange as a percentage in decimal form. (must be between 0 and 1)\n     * @param {Number} opts.left If Gradient fill, the position of the left edge of the inner rectange as a percentage in decimal form. (must be between 0 and 1)\n     * @param {Number} opts.right If Gradient fill, the position of the right edge of the inner rectange as a percentage in decimal form. (must be between 0 and 1)\n     * @param {Number} opts.degree Angle of the Gradient\n     * @param {Array.Stop} opts.stops Array of position stops for gradient\n     * @returns {Fill}\n     */\n    constructor(opts) {\n\n        if (['gradient', 'pattern', 'none'].indexOf(opts.type) >= 0) {\n            this.type = opts.type;\n        } else {\n            throw new TypeError('Fill type must be one of gradient, pattern or none.');\n        }\n\n        switch (this.type) {\n        case 'gradient': //ยง18.8.24\n            if (opts.bottom !== undefined) {\n                if (opts.bottom < 0 || opts.bottom > 1) {\n                    throw new TypeError('Values for gradient fill bottom attribute must be a decimal between 0 and 1');\n                } else {\n                    this.bottom = opts.bottom;\n                }\n            }\n\n            if (opts.degree !== undefined) {\n                if (typeof opts.degree === 'number') {\n                    this.degree = opts.degree;\n                } else {\n                    throw new TypeError('Values of gradient fill degree must be of type number.');\n                }\n            }\n\n\n            if (opts.left !== undefined) {\n                if (opts.left < 0 || opts.left > 1) {\n                    throw new TypeError('Values for gradient fill left attribute must be a decimal between 0 and 1');\n                } else {\n                    this.left = opts.left;\n                }\n            }\n\n            if (opts.right !== undefined) {\n                if (opts.right < 0 || opts.right > 1) {\n                    throw new TypeError('Values for gradient fill right attribute must be a decimal between 0 and 1');\n                } else {\n                    this.right = opts.right;\n                }\n            }\n\n            if (opts.top !== undefined) {\n                if (opts.top < 0 || opts.top > 1) {\n                    throw new TypeError('Values for gradient fill top attribute must be a decimal between 0 and 1');\n                } else {\n                    this.top = opts.top;\n                }\n            }\n\n            if (opts.stops !== undefined) {\n                if (opts.stops instanceof Array) {\n                    opts.stops.forEach((s, i) => {\n                        this.stops.push(new Stop(s, i));\n                    });\n                } else {\n                    throw new TypeError('Stops for gradient fills must be sent as an Array');\n                }\n            }\n\n            break;\n\n        case 'pattern': //ยง18.8.32\n            if (opts.bgColor !== undefined) {\n                this.bgColor = new CTColor(opts.bgColor);\n            }\n\n            if (opts.fgColor !== undefined) {\n                this.fgColor = new CTColor(opts.fgColor);\n            }\n\n            if (opts.patternType !== undefined) {\n                types.fillPattern.validate(opts.patternType) === true ? this.patternType = opts.patternType : null; \n            }\n            break;\n\n        case 'none':\n            this.patternType = 'none';\n            break;\n        }\n    }\n\n    /** \n     * @func Fill.toObject\n     * @desc Converts the Fill instance to a javascript object\n     * @returns {Object}\n     */\n    toObject() {\n        let obj = {};\n\n        this.type !== undefined ? obj.type = this.type : null;\n        this.bottom !== undefined ? obj.bottom = this.bottom : null;\n        this.degree !== undefined ? obj.degree = this.degree : null;\n        this.left !== undefined ? obj.left = this.left : null;\n        this.right !== undefined ? obj.right = this.right : null;\n        this.top !== undefined ? obj.top = this.top : null;\n        this.bgColor !== undefined ? obj.bgColor = this.bgColor.toObject() : null;\n        this.fgColor !== undefined ? obj.fgColor = this.fgColor.toObject() : null;\n        this.patternType !== undefined ? obj.patternType = this.patternType : null;\n\n        if (this.stops !== undefined) {\n            obj.stop = [];\n            this.stops.forEach((s) => {\n                obj.stops.push(s.toObject());\n            });\n        }\n\n        return obj;\n    }\n\n    /**\n     * @alias Fill.addToXMLele\n     * @desc When generating Workbook output, attaches style to the styles xml file\n     * @func Fill.addToXMLele\n     * @param {xmlbuilder.Element} ele Element object of the xmlbuilder module\n     */\n    addToXMLele(fXML) {\n        let pFill = fXML.ele('patternFill').att('patternType', this.patternType);\n\n        if (this.fgColor instanceof CTColor) {\n            pFill.ele('fgColor').att(this.fgColor.type, this.fgColor[this.fgColor.type]);\n        }\n\n        if (this.bgColor instanceof CTColor) {\n            pFill.ele('bgColor').att(this.bgColor.type, this.bgColor[this.bgColor.type]);\n        }\n    }\n}\n\nmodule.exports = Fill;"]}
{"version":3,"sources":["../../../source/lib/worksheet/optsValidator.js"],"names":[],"mappings":";;;;AAAA,IAAM,QAAQ,QAAQ,mBAAR,CAAR;;AAEN,IAAM,YAAY;AACd,eAAW;AACP,kBAAU,OAAV;AACA,kBAAU,OAAV;AACA,kBAAU,OAAV;AACA,gBAAQ,OAAR;AACA,iBAAS,OAAT;AACA,eAAO,OAAP;KANJ;AAQA,oBAAgB;AACZ,4BAAoB,SAApB;AACA,0BAAkB,SAAlB;AACA,0BAAkB,SAAlB;AACA,yBAAiB,SAAjB;;KAJJ;AAOA,iBAAa;AACT,yBAAiB,SAAjB;AACA,wBAAgB,eAAhB;AACA,kBAAU,SAAV;AACA,iBAAS,SAAT;AACA,kBAAU,aAAV;AACA,2BAAmB,SAAnB;AACA,uBAAe,SAAf;AACA,sBAAc,SAAd;AACA,yBAAiB,SAAjB;AACA,uBAAe,aAAf;AACA,qBAAa,YAAb;AACA,uBAAe,4BAAf;AACA,qBAAa,YAAb;AACA,sBAAc,4BAAd;AACA,iBAAS,SAAT;AACA,8BAAsB,SAAtB;AACA,8BAAsB,SAAtB;AACA,uBAAe,SAAf;KAlBJ;AAoBA,oBAAgB;AACZ,sBAAc,QAAd;AACA,sBAAc,QAAd;AACA,uBAAe,QAAf;AACA,uBAAe,QAAf;AACA,qBAAa,QAAb;AACA,qBAAa,QAAb;AACA,4BAAoB,SAApB;AACA,0BAAkB,SAAlB;AACA,4BAAoB,SAApB;AACA,wBAAgB,SAAhB;KAVJ;AAYA,iBAAa;AACT,gBAAQ;AACJ,0BAAc,MAAd;AACA,qBAAS,YAAT;AACA,2BAAe,IAAf;AACA,sBAAU,IAAV;AACA,sBAAU,IAAV;SALJ;AAOA,uBAAe,IAAf;AACA,0BAAkB,IAAlB;AACA,uBAAe,IAAf;AACA,qBAAa,IAAb;AACA,2BAAmB,IAAnB;AACA,mCAA2B,IAA3B;KAbJ;AAeA,mBAAe;AACX,wBAAgB,IAAhB;AACA,wBAAgB,IAAhB;AACA,2BAAmB,IAAnB;AACA,4BAAoB,IAApB;AACA,2BAAmB,IAAnB;AACA,2BAAmB,IAAnB;AACA,uBAAe,IAAf;AACA,oBAAY,IAAZ;AACA,sBAAc,IAAd;KATJ;AAWA,uBAAmB;AACf,sBAAc,IAAd;AACA,yBAAiB,IAAjB;AACA,qBAAa,IAAb;AACA,uBAAe,IAAf;AACA,yBAAiB,IAAjB;AACA,sBAAc,IAAd;AACA,qBAAa,IAAb;AACA,yBAAiB,IAAjB;AACA,4BAAoB,IAApB;AACA,sBAAc,IAAd;AACA,mBAAW,IAAX;AACA,oBAAY,IAAZ;AACA,uBAAe,IAAf;AACA,qBAAa,IAAb;AACA,6BAAqB,IAArB;AACA,8BAAsB,IAAtB;AACA,iBAAS,IAAT;AACA,gBAAQ,IAAR;KAlBJ;AAoBA,eAAW;AACP,wBAAgB,IAAhB;KADJ;AAGA,kBAAc;AACV,oBAAY,IAAZ;AACA,kBAAU,IAAV;AACA,oBAAY,IAAZ;AACA,kBAAU,IAAV;AACA,mBAAW,IAAX;KALJ;CAjGE;;AA0GN,IAAI,aAAa,SAAb,UAAa,CAAC,GAAD,EAAM,GAAN,EAAc;AAC3B,QAAI,YAAY,GAAZ,CADuB;AAE3B,QAAI,SAAS,IAAI,KAAJ,CAAU,GAAV,CAAT,CAFuB;;AAI3B,WAAO,OAAO,MAAP,GAAgB,CAAhB,EAAmB;AACtB,YAAI,eAAe,OAAO,KAAP,EAAf,CADkB;AAEtB,YAAI;AACA,wBAAY,UAAU,YAAV,CAAZ,CADA;SAAJ,CAEE,OAAO,CAAP,EAAU;;SAAV;KAJN;AAQA,WAAO,SAAP,CAZ2B;CAAd;;AAejB,IAAI,YAAY,SAAZ,SAAY,CAAU,GAAV,EAAe,GAAf,EAAoB,IAApB,EAA0B;AACtC,YAAQ,IAAR;;AAEA,aAAK,YAAL;AACI,gBAAI,QAAQ,OAAO,IAAP,CAAY,MAAM,SAAN,CAApB,CADR;AAEI,gBAAI,MAAM,OAAN,CAAc,GAAd,IAAqB,CAArB,EAAwB;AACxB,sBAAM,IAAI,SAAJ,CAAc,uBAAuB,GAAvB,GAA6B,yBAA7B,GAAyD,MAAM,IAAN,CAAW,IAAX,CAAzD,CAApB,CADwB;aAA5B;AAGA,kBALJ;;AAFA,aASK,YAAL;AACI,kBAAM,SAAN,CAAgB,QAAhB,CAAyB,GAAzB,EADJ;AAEI,kBAFJ;;AATA,aAaK,aAAL;AACI,kBAAM,WAAN,CAAkB,QAAlB,CAA2B,GAA3B,EADJ;AAEI,kBAFJ;;AAbA,aAiBK,4BAAL;AACI,kBAAM,wBAAN,CAA+B,QAA/B,CAAwC,GAAxC,EADJ;AAEI,kBAFJ;;AAjBA,aAqBK,eAAL;AACI,kBAAM,WAAN,CAAkB,QAAlB,CAA2B,GAA3B,EADJ;AAEI,kBAFJ;;AArBA,aAyBK,aAAL;AACI,kBAAM,UAAN,CAAiB,QAAjB,CAA0B,GAA1B,EADJ;AAEI,kBAFJ;;AAzBA,aA6BK,MAAL;AACI,kBAAM,IAAN,CAAW,QAAX,CAAoB,GAApB,EADJ;AAEI,kBAFJ;;AA7BA,aAiCK,YAAL;AACI,kBAAM,SAAN,CAAgB,QAAhB,CAAyB,GAAzB,EADJ;AAEI,kBAFJ;;AAjCA,aAqCK,SAAL;AACI,gBAAI,CAAC,IAAD,EAAO,KAAP,EAAc,CAAd,EAAiB,CAAjB,EAAoB,OAApB,CAA4B,GAA5B,IAAmC,CAAnC,EAAsC;AACtC,sBAAM,IAAI,SAAJ,CAAc,MAAM,uCAAN,CAApB,CADsC;aAA1C;AAGA,kBAJJ;;AArCA,aA2CK,OAAL;AACI,gBAAI,WAAW,GAAX,MAAoB,GAApB,EAAyB;AACzB,sBAAM,IAAI,SAAJ,CAAc,MAAM,kCAAN,CAApB,CADyB;aAA7B;AAGA,kBAJJ;;AA3CA,aAiDK,SAAL;AACI,gBAAI,SAAS,GAAT,MAAkB,GAAlB,EAAuB;AACvB,sBAAM,IAAI,SAAJ,CAAc,MAAM,8BAAN,CAApB,CADuB;aAA3B;AAGA,kBAJJ;;AAjDA,aAuDK,QAAL;AACI,gBAAI,OAAO,GAAP,KAAe,QAAf,EAAyB;AACzB,sBAAM,IAAI,SAAJ,CAAc,MAAM,4BAAN,CAApB,CADyB;aAA7B;AAGA,kBAJJ;;AAvDA;AA8DI,kBADJ;AA7DA,KADsC;CAA1B;;AAmEhB,IAAI,WAAW,SAAX,QAAW,CAAU,CAAV,EAAa,QAAb,EAAuB,IAAvB,EAA6B;AACxC,SAAK,IAAI,CAAJ,IAAS,CAAd,EAAiB;AACb,YAAI,eAAe,SAAS,MAAT,CAAgB,CAAhB,CAAf,CADS;AAEb,YAAI,UAAU,aAAa,IAAb,CAAkB,GAAlB,CAAV,CAFS;AAGb,YAAI,WAAW,WAAW,SAAX,EAAsB,OAAtB,CAAX,CAHS;;AAKb,YAAI,OAAO,QAAP,KAAoB,QAApB,EAA8B;AAC9B,gBAAI,WAAW,EAAE,CAAF,CAAX,CAD0B;AAE9B,iBAAK,OAAL,EAAc,QAAd,EAAwB,QAAxB,EAF8B;SAAlC;AAIA,YAAI,EAAE,CAAF,MAAS,IAAT,IAAiB,QAAO,EAAE,CAAF,EAAP,KAAgB,QAAhB,EAA0B;AAC3C,qBAAS,EAAE,CAAF,CAAT,EAAe,YAAf,EAA6B,IAA7B,EAD2C;SAA/C;KATJ;CADW;;AAgBf,OAAO,OAAP,GAAiB,UAAC,IAAD,EAAU;AACvB,aAAS,IAAT,EAAe,EAAf,EAAmB,SAAnB,EADuB;CAAV","file":"optsValidator.js","sourcesContent":["const types = require('../types/index.js');\n\nconst optsTypes = {\n    'margins': {\n        'bottom': 'Float',\n        'footer': 'Float',\n        'header': 'Float',\n        'left': 'Float',\n        'right': 'Float',\n        'top': 'Float'\n    },\n    'printOptions': {\n        'centerHorizontal': 'Boolean',\n        'centerVertical': 'Boolean',\n        'printGridLines': 'Boolean',\n        'printHeadings': 'Boolean'\n    \n    },\n    'pageSetup': {\n        'blackAndWhite': 'Boolean',\n        'cellComments': 'CELL_COMMENTS',\n        'copies': 'Integer',\n        'draft': 'Boolean',\n        'errors': 'PRINT_ERROR',\n        'firstPageNumber': 'Boolean',\n        'fitToHeight': 'Integer',\n        'fitToWidth': 'Integer',\n        'horizontalDpi': 'Integer',\n        'orientation': 'ORIENTATION',\n        'pageOrder': 'PAGE_ORDER',\n        'paperHeight': 'POSITIVE_UNIVERSAL_MEASURE',\n        'paperSize': 'PAPER_SIZE',\n        'paperWidth': 'POSITIVE_UNIVERSAL_MEASURE',\n        'scale': 'Integer',\n        'useFirstPageNumber': 'Boolean',\n        'usePrinterDefaults': 'Boolean',\n        'verticalDpi': 'Integer'\n    },\n    'headerFooter': {\n        'evenFooter': 'String',\n        'evenHeader': 'String',\n        'firstFooter': 'String',\n        'firstHeader': 'String',\n        'oddFooter': 'String',\n        'oddHeader': 'String',\n        'alignWithMargins': 'Boolean',\n        'differentFirst': 'Boolean',\n        'differentOddEven': 'Boolean',\n        'scaleWithDoc': 'Boolean'\n    },\n    'sheetView': {\n        'pane': {\n            'activePane': 'PANE',\n            'state': 'PANE_STATE',\n            'topLeftCell': null,\n            'xSplit': null,\n            'ySplit': null\n        },\n        'tabSelected': null,\n        'workbookViewId': null,\n        'rightToLeft': null,\n        'zoomScale': null,\n        'zoomScaleNormal': null,\n        'zoomScalePageLayoutView': null\n    },\n    'sheetFormat': {\n        'baseColWidth': null,\n        'customHeight': null,\n        'defaultColWidth': null,\n        'defaultRowHeight': null,\n        'outlineLevelCol': null,\n        'outlineLevelRow': null,\n        'thickBottom': null,\n        'thickTop': null,\n        'zeroHeight': null\n    },\n    'sheetProtection': {\n        'autoFilter': null,\n        'deleteColumns': null,\n        'deleteRow': null,\n        'formatCells': null,\n        'formatColumns': null,\n        'formatRows': null,\n        'hashValue': null,\n        'insertColumns': null,\n        'insertHyperlinks': null,\n        'insertRows': null,\n        'objects': null,\n        'password': null,\n        'pivotTables': null,\n        'scenarios': null,\n        'selectLockedCells': null,\n        'selectUnlockedCell': null,\n        'sheet': null,\n        'sort': null\n    },\n    'outline': {\n        'summaryBelow': null\n    },\n    'autoFilter': {\n        'startRow': null,\n        'endRow': null,\n        'startCol': null,\n        'endCol': null,\n        'filters': null\n    }\n};\n\nlet getObjItem = (obj, key) => {\n    let returnObj = obj;\n    let levels = key.split('.');\n\n    while (levels.length > 0) {\n        let thisLevelKey = levels.shift();\n        try {\n            returnObj = returnObj[thisLevelKey];\n        } catch (e) {\n            //returnObj = undefined;\n        }\n    }\n    return returnObj;\n};\n\nlet validator = function (key, val, type) {\n    switch (type) {\n\n    case 'PAPER_SIZE': \n        let sizes = Object.keys(types.paperSize);\n        if (sizes.indexOf(val) < 0) {\n            throw new TypeError('Invalid value for ' + key + '. Value must be one of ' + sizes.join(', '));\n        }\n        break;\n\n    case 'PAGE_ORDER':\n        types.pageOrder.validate(val);\n        break;\n\n    case 'ORIENTATION':\n        types.orientation.validate(val);\n        break;\n\n    case 'POSITIVE_UNIVERSAL_MEASURE': \n        types.positiveUniversalMeasure.validate(val);\n        break;\n\n    case 'CELL_COMMENTS':\n        types.cellComment.validate(val);\n        break;\n\n    case 'PRINT_ERROR': \n        types.printError.validate(val);\n        break;\n\n    case 'PANE':\n        types.pane.validate(val);\n        break;\n\n    case 'PANE_STATE':\n        types.paneState.validate(val);\n        break;\n\n    case 'Boolean':\n        if ([true, false, 1, 0].indexOf(val) < 0) {\n            throw new TypeError(key + ' expects value of true, false, 1 or 0');\n        }\n        break;\n\n    case 'Float': \n        if (parseFloat(val) !== val) {\n            throw new TypeError(key + ' expects value as a Float number');\n        }\n        break;\n\n    case 'Integer':\n        if (parseInt(val) !== val) {\n            throw new TypeError(key + ' expects value as an Integer');\n        }\n        break;\n\n    case 'String': \n        if (typeof val !== 'string') {\n            throw new TypeError(key + ' expects value as a String');\n        }\n        break;\n\n    default:\n        break;\n    }\n};\n\nlet traverse = function (o, keyParts, func) {\n    for (let i in o) {\n        let thisKeyParts = keyParts.concat(i);\n        let thisKey = thisKeyParts.join('.');\n        let thisType = getObjItem(optsTypes, thisKey);\n\n        if (typeof thisType === 'string') {\n            let thisItem = o[i];\n            func(thisKey, thisItem, thisType); \n        }\n        if (o[i] !== null && typeof o[i] === 'object') {\n            traverse(o[i], thisKeyParts, func);\n        }\n    }\n};\n\nmodule.exports = (opts) => {\n    traverse(opts, [], validator);\n};"]}
{"version":3,"sources":["../../../source/lib/worksheet/builder.js"],"names":[],"mappings":"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","file":"builder.js","sourcesContent":["const xml = require('xmlbuilder');\nconst utils = require('../utils.js');\nconst types = require('../types/index.js');\nconst hyperlinks = require('./classes/hyperlink');\nconst Picture = require('../drawing/picture.js');\n\nlet _addSheetPr = (promiseObj) => {\n    // §18.3.1.82 sheetPr (Sheet Properties)\n    return new Promise((resolve, reject) => {\n        let o = promiseObj.ws.opts;\n\n        // Check if any option that would require the sheetPr element to be added exists\n        if (\n            o.printOptions.fitToHeight !== null || \n            o.printOptions.fitToWidth !== null || \n            o.outline.summaryBelow !== null ||\n            o.autoFilter.ref !== null ||\n            o.outline.summaryRight\n\n        ) {\n            let ele = promiseObj.xml.ele('sheetPr');\n\n            if (o.autoFilter.ref) {\n                ele.att('enableFormatConditionsCalculation', 1);\n                ele.att('filterMode', 1);\n            }\n\n            if (o.outline.summaryBelow !== null || o.outline.summaryRight !== null) {\n                let outlineEle = ele.ele('outlinePr');\n                outlineEle.att('applyStyles', 1);\n                o.outline.summaryBelow === true ? outlineEle.att('summaryBelow', 1) : null;\n                o.outline.summaryRight === true ? outlineEle.att('summaryRight', 1) : null;\n            }\n\n            // §18.3.1.65 pageSetUpPr (Page Setup Properties)\n            if (o.pageSetup.fitToHeight !== null || o.pageSetup.fitToWidth !== null) {\n                ele.ele('pageSetUpPr').att('fitToPage', 1);\n            }\n        }\n\n        resolve(promiseObj);\n    });\n};\n\nlet _addDimension = (promiseObj) => {\n    // §18.3.1.35 dimension (Worksheet Dimensions)\n    return new Promise((resolve, reject) => {\n        let firstCell = 'A1';\n        let lastCell = `${utils.getExcelAlpha(promiseObj.ws.lastUsedCol)}${promiseObj.ws.lastUsedRow}`;\n        let ele = promiseObj.xml.ele('dimension');\n        ele.att('ref', `${firstCell}:${lastCell}`);\n\n        resolve(promiseObj);\n    });\n};\n\nlet _addSheetViews = (promiseObj) => {\n    // §18.3.1.88 sheetViews (Sheet Views)\n    return new Promise((resolve, reject) => {\n        let o = promiseObj.ws.opts.sheetView;\n        let ele = promiseObj.xml.ele('sheetViews');\n        let tabSelected = promiseObj.ws.opts;\n        let sv = ele.ele('sheetView')\n        .att('tabSelected', o.tabSelected)\n        .att('workbookViewId', o.workbookViewId)\n        .att('rightToLeft', o.rightToLeft)\n        .att('zoomScale', o.zoomScale)\n        .att('zoomScaleNormal', o.zoomScaleNormal)\n        .att('zoomScalePageLayoutView', o.zoomScalePageLayoutView);\n\n        let modifiedPaneParams = [];\n        Object.keys(o.pane).forEach((k) => {\n            if (o.pane[k] !== null) {\n                modifiedPaneParams.push(k);\n            }\n        });\n        if (modifiedPaneParams.length > 0) {\n            let pEle = sv.ele('pane');\n            o.pane.xSplit !== null ? pEle.att('xSplit', o.pane.xSplit) : null;\n            o.pane.ySplit !== null ? pEle.att('ySplit', o.pane.ySplit) : null;\n            o.pane.topLeftCell !== null ? pEle.att('topLeftCell', o.pane.topLeftCell) : null;\n            o.pane.activePane !== null ? pEle.att('activePane', o.pane.activePane) : null;\n            o.pane.state !== null ? pEle.att('state', o.pane.state) : null;\n        }\n\n        resolve(promiseObj);\n    });\n};\n\nlet _addSheetFormatPr = (promiseObj) => {\n    // §18.3.1.81 sheetFormatPr (Sheet Format Properties)\n    return new Promise((resolve, reject) => {\n        let o = promiseObj.ws.opts.sheetFormat;\n        let ele = promiseObj.xml.ele('sheetFormatPr');\n\n        o.baseColWidth !== null ? ele.att('baseColWidth', o.baseColWidth) : null;\n        o.defaultColWidth !== null ? ele.att('defaultColWidth', o.defaultColWidth) : null;\n        o.defaultRowHeight !== null ? ele.att('defaultRowHeight', o.defaultRowHeight) : null;\n        o.thickBottom !== null ? ele.att('thickBottom', utils.boolToInt(o.thickBottom)) : null;\n        o.thickTop !== null ? ele.att('thickTop', utils.boolToInt(o.thickTop)) : null;\n\n\n        if (typeof o.defaultRowHeight === 'number') {\n            ele.att('customHeight', '1');\n        }\n\n        resolve(promiseObj);\n    });\n};\n\nlet _addCols = (promiseObj) => {\n    // §18.3.1.17 cols (Column Information)\n    return new Promise((resolve, reject) => {\n\n        if (promiseObj.ws.columnCount > 0) {\n            let colsEle = promiseObj.xml.ele('cols');\n\n            for (let colId in promiseObj.ws.cols) {\n                let col = promiseObj.ws.cols[colId];\n                let colEle = colsEle.ele('col');\n                \n                col.min !== null ? colEle.att('min', col.min) : null;\n                col.max !== null ? colEle.att('max', col.max) : null;\n                col.width !== null ? colEle.att('width', col.width) : null;\n                col.style !== null ? colEle.att('style', col.style) : null;\n                col.hidden !== null ? colEle.att('hidden', utils.boolToInt(col.hidden)) : null;\n                col.customWidth !== null ? colEle.att('customWidth', utils.boolToInt(col.customWidth)) : null;\n                col.outlineLevel !== null ? colEle.att('outlineLevel', col.outlineLevel) : null;\n                col.collapsed !== null ? colEle.att('collapsed', utils.boolToInt(col.collapsed)) : null;\n            }\n        }\n\n        resolve(promiseObj);\n    });\n};\n\nlet _addSheetData = (promiseObj) => {\n    // §18.3.1.80 sheetData (Sheet Data)\n    return new Promise((resolve, reject) => {\n\n        let ele = promiseObj.xml.ele('sheetData');\n        let rows = Object.keys(promiseObj.ws.rows);\n\n        let processNextRows = (rowCount) => {\n\n            let theseRows = rows.splice(0, rowCount);\n            if (theseRows.length === 0) {\n                return resolve(promiseObj);\n            }\n\n            theseRows.forEach((r) => {\n                let thisRow = promiseObj.ws.rows[r];\n                thisRow.cellRefs.sort(utils.sortCellRefs);\n\n                let rEle = ele.ele('row');\n                // If defaultRowHeight !== 16, set customHeight attribute to 1 as stated in §18.3.1.81\n                if (promiseObj.ws.opts.sheetFormat.defaultRowHeight !== 16) {\n                    rEle.att('customHeight', '1');\n                }\n\n                rEle.att('r', thisRow.r);\n                rEle.att('spans', thisRow.spans);\n                thisRow.s !== null ? rEle.att('s', thisRow.s) : null;\n                thisRow.customFormat !== null ? rEle.att('customFormat', thisRow.customFormat) : null;\n                thisRow.ht !== null ? rEle.att('ht', thisRow.ht) : null;\n                thisRow.hidden !== null ? rEle.att('hidden', thisRow.hidden) : null;\n                thisRow.customHeight !== null ? rEle.att('customHeight', thisRow.customHeight) : null;\n                thisRow.outlineLevel !== null ? rEle.att('outlineLevel', thisRow.outlineLevel) : null;\n                thisRow.collapsed !== null ? rEle.att('collapsed', thisRow.collapsed) : null;\n                thisRow.thickTop !== null ? rEle.att('thickTop', thisRow.thickTop) : null;\n                thisRow.thickBot !== null ? rEle.att('thickBot', thisRow.thickBot) : null;\n\n                thisRow.cellRefs.forEach((c) => {\n                    promiseObj.ws.cells[c].addToXMLele(rEle);\n                });\n            });\n\n            processNextRows(rowCount);\n        };\n\n        processNextRows(500);\n\n    });\n};\n\nlet _addSheetProtection = (promiseObj) => {\n    // §18.3.1.85 sheetProtection (Sheet Protection Options)\n    return new Promise((resolve, reject) => {\n        let o = promiseObj.ws.opts.sheetProtection;\n        let includeSheetProtection = false;\n        Object.keys(o).forEach((k) =>  {\n            if (o[k] !== null) {\n                includeSheetProtection = true;\n            }\n        });\n\n        if (includeSheetProtection) {\n            // Set required fields with defaults if not specified\n            o.sheet = o.sheet !== null ? o.sheet : true;\n            o.objects = o.objects !== null ? o.objects : true;\n            o.scenarios = o.scenarios !== null ? o.scenarios : true;\n\n            let ele = promiseObj.xml.ele('sheetProtection');\n            Object.keys(o).forEach((k) => {\n                if (o[k] !== null) {\n                    if (k === 'password') {\n                        ele.att('password', utils.getHashOfPassword(o[k]));\n                    } else {\n                        ele.att(k, utils.boolToInt(o[k]));\n                    }\n                }            \n            });\n        }\n        resolve(promiseObj);\n    });\n};\n\nlet _addAutoFilter = (promiseObj) => {\n    // §18.3.1.2 autoFilter (AutoFilter Settings)\n    return new Promise((resolve, reject) => {\n        let o = promiseObj.ws.opts.autoFilter;\n\n        if (typeof o.startRow === 'number') {\n            let ele = promiseObj.xml.ele('autoFilter');\n            let filterRow = promiseObj.ws.rows[o.startRow];\n\n            o.startCol = typeof o.startCol === 'number' ? o.startCol : null;\n            o.endCol = typeof o.endCol === 'number' ? o.endCol : null;\n\n            if (typeof o.endRow !== 'number') {\n                let firstEmptyRow = undefined;\n                let curRow = o.startRow;\n                while (firstEmptyRow === undefined) {\n                    if (!promiseObj.ws.rows[curRow]) {\n                        firstEmptyRow = curRow;\n                    } else {\n                        curRow++;\n                    }\n                }\n\n                o.endRow = firstEmptyRow - 1;\n            }\n\n            // Columns to sort not manually set. filter all columns in this row containing data.\n            if (typeof o.startCol !== 'number' || typeof o.endCol !== 'number') {\n                o.startCol = filterRow.firstColumn;\n                o.endCol = filterRow.lastColumn;\n            }\n\n            let startCell = utils.getExcelAlpha(o.startCol) + o.startRow;\n            let endCell = utils.getExcelAlpha(o.endCol) + o.endRow;\n\n            ele.att('ref', `${startCell}:${endCell}`);\n            promiseObj.ws.wb.definedNameCollection.addDefinedName({\n                hidden: 1,\n                localSheetId: promiseObj.ws.localSheetId,\n                name: '_xlnm._FilterDatabase',\n                refFormula: '\\'' + promiseObj.ws.name + '\\'!' +\n                    '$' + utils.getExcelAlpha(o.startCol) + \n                    '$' + o.startRow +\n                    ':' +\n                    '$' + utils.getExcelAlpha(o.endCol) + \n                    '$' + o.endRow\n            });\n\n        }\n        resolve(promiseObj);\n    });\n};\n\nlet _addMergeCells = (promiseObj) => {\n    // §18.3.1.55 mergeCells (Merge Cells)\n    return new Promise((resolve, reject) => {\n\n        if (promiseObj.ws.mergedCells instanceof Array && promiseObj.ws.mergedCells.length > 0) {\n            let ele = promiseObj.xml.ele('mergeCells').att('count', promiseObj.ws.mergedCells.length);\n            promiseObj.ws.mergedCells.forEach((cr) => {\n                ele.ele('mergeCell').att('ref', cr);\n            });\n        }\n\n        resolve(promiseObj);\n    });\n};\n\nlet _addConditionalFormatting = (promiseObj) => {\n    // §18.3.1.18 conditionalFormatting (Conditional Formatting)\n    return new Promise((resolve, reject) => {\n        promiseObj.ws.cfRulesCollection.addToXMLele(promiseObj.xml);\n        resolve(promiseObj);\n    });\n};\n\nlet _addHyperlinks = (promiseObj) => {\n    // §18.3.1.48 hyperlinks (Hyperlinks)\n    return new Promise((resolve, reject) => {\n        promiseObj.ws.hyperlinkCollection.addToXMLele(promiseObj.xml);\n        resolve(promiseObj);\n    });\n};\n\nlet _addDataValidations = (promiseObj) => {\n    // §18.3.1.33 dataValidations (Data Validations)\n    return new Promise((resolve, reject) => {\n        if (promiseObj.ws.dataValidationCollection.length > 0) {\n            promiseObj.ws.dataValidationCollection.addToXMLele(promiseObj.xml);\n        }\n        resolve(promiseObj);\n    });\n};\n\nlet _addPrintOptions = (promiseObj) => {\n    // §18.3.1.70 printOptions (Print Options)\n    return new Promise((resolve, reject) => {\n\n        let addPrintOptions = false;\n        let o = promiseObj.ws.opts.printOptions;\n        Object.keys(o).forEach((k) => {\n            if (o[k] !== null) {\n                addPrintOptions = true;\n            }\n        });\n\n        if (addPrintOptions) {\n            let poEle = promiseObj.xml.ele('printOptions');\n            o.centerHorizontal === true ? poEle.att('horizontalCentered', 1) : null;\n            o.centerVertical === true ? poEle.att('verticalCentered', 1) : null;\n            o.printHeadings === true ? poEle.att('headings', 1) : null;\n            if (o.printGridLines === true) {\n                poEle.att('gridLines', 1);\n                poEle.att('gridLinesSet', 1);\n            } \n        }\n\n        resolve(promiseObj);\n    });\n};\n\nlet _addPageMargins = (promiseObj) => {\n    // §18.3.1.62 pageMargins (Page Margins)\n    return new Promise((resolve, reject) => {\n        let o = promiseObj.ws.opts.margins;\n\n        promiseObj.xml.ele('pageMargins')\n        .att('left', o.left)\n        .att('right', o.right)\n        .att('top', o.top)\n        .att('bottom', o.bottom)\n        .att('header', o.header)\n        .att('footer', o.footer);\n\n        resolve(promiseObj);\n    });\n};\n\nlet _addPageSetup = (promiseObj) => {\n    // §18.3.1.63 pageSetup (Page Setup Settings)\n    return new Promise((resolve, reject) => {\n\n        let addPageSetup = false;\n        let o = promiseObj.ws.opts.pageSetup;\n        Object.keys(o).forEach((k) => {\n            if (o[k] !== null) {\n                addPageSetup = true;\n            }\n        });\n\n        if (addPageSetup === true) {\n            let psEle = promiseObj.xml.ele('pageSetup');\n            o.paperSize !== null ? psEle.att('paperSize', types.paperSize[o.paperSize]) : null;\n            o.paperHeight !== null ? psEle.att('paperHeight', o.paperHeight) : null;\n            o.paperWidth !== null ? psEle.att('paperWidth', o.paperWidth) : null;\n            o.scale !== null ? psEle.att('scale', o.scale) : null;\n            o.firstPageNumber !== null ? psEle.att('firstPageNumber', o.firstPageNumber) : null;\n            o.fitToWidth !== null ? psEle.att('fitToWidth', o.fitToWidth) : null;\n            o.fitToHeight !== null ? psEle.att('fitToHeight', o.fitToHeight) : null;\n            o.pageOrder !== null ? psEle.att('pageOrder', o.pageOrder) : null;\n            o.orientation !== null ? psEle.att('orientation', o.orientation) : null;\n            o.usePrinterDefaults !== null ? psEle.att('usePrinterDefaults', utils.boolToInt(o.usePrinterDefaults)) : null;\n            o.blackAndWhite !== null ? psEle.att('blackAndWhite', utils.boolToInt(o.blackAndWhite)) : null;\n            o.draft !== null ? psEle.att('draft', utils.boolToInt(o.draft)) : null;\n            o.cellComments !== null ? psEle.att('cellComments', o.cellComments) : null;\n            o.useFirstPageNumber !== null ? psEle.att('useFirstPageNumber', utils.boolToInt(o.useFirstPageNumber)) : null;\n            o.errors !== null ? psEle.att('errors', o.errors) : null;\n            o.horizontalDpi !== null ? psEle.att('horizontalDpi', o.horizontalDpi) : null;\n            o.verticalDpi !== null ? psEle.att('verticalDpi', o.verticalDpi) : null;\n            o.copies !== null ? psEle.att('copies', o.copies) : null;\n        }\n\n        resolve(promiseObj);\n    });\n};\n\nlet _addHeaderFooter = (promiseObj) => {\n    // §18.3.1.46 headerFooter (Header Footer Settings)\n    return new Promise((resolve, reject) => {\n\n        let addHeaderFooter = false;\n        let o = promiseObj.ws.opts.headerFooter;\n        Object.keys(o).forEach((k) => {\n            if (o[k] !== null) {\n                addHeaderFooter = true;\n            }\n        });\n\n        if (addHeaderFooter === true) {\n            let hfEle = promiseObj.xml.ele('headerFooter');\n            o.oddHeader !== null ? hfEle.ele('oddHeader').text(o.oddHeader) : null;\n            o.oddFooter !== null ? hfEle.ele('oddFooter').text(o.oddFooter) : null;\n            o.evenHeader !== null ? hfEle.ele('evenHeader').text(o.evenHeader) : null;\n            o.evenFooter !== null ? hfEle.ele('evenFooter').text(o.evenFooter) : null;\n            o.firstHeader !== null ? hfEle.ele('firstHeader').text(o.firstHeader) : null;\n            o.firstFooter !== null ? hfEle.ele('firstFooter').text(o.firstFooter) : null;\n            o.alignWithMargins !== null ? hfEle.att('alignWithMargins', utils.boolToInt(o.alignWithMargins)) : null;\n            o.differentFirst !== null ? hfEle.att('differentFirst', utils.boolToInt(o.differentFirst)) : null;\n            o.differentOddEven !== null ? hfEle.att('differentOddEven', utils.boolToInt(o.differentOddEven)) : null;\n            o.scaleWithDoc !== null ? hfEle.att('scaleWithDoc', utils.boolToInt(o.scaleWithDoc)) : null;\n        }\n\n        resolve(promiseObj);\n    });\n};\n\nlet _addDrawing = (promiseObj) => {\n    // §18.3.1.36 drawing (Drawing)\n    return new Promise((resolve, reject) => {\n        if (!promiseObj.ws.drawingCollection.isEmpty) {\n            let dId = promiseObj.ws.relationships.indexOf('drawing') + 1;\n            promiseObj.xml.ele('drawing').att('r:id', 'rId' + dId);\n        }\n        resolve(promiseObj);\n    });\n};\n\nlet sheetXML = (ws) => {\n    return new Promise((resolve, reject) => {\n\n        let wsXML = xml.create(\n            'worksheet',\n            {\n                'version': '1.0', \n                'encoding': 'UTF-8', \n                'standalone': true\n            },\n            { pubID: null, sysID: null },\n            { allowSurrogateChars: true }\n        )\n        .att('mc:Ignorable', 'x14ac')\n        .att('xmlns', 'http://schemas.openxmlformats.org/spreadsheetml/2006/main')\n        .att('xmlns:mc', 'http://schemas.openxmlformats.org/markup-compatibility/2006')\n        .att('xmlns:r', 'http://schemas.openxmlformats.org/officeDocument/2006/relationships')\n        .att('xmlns:x14ac', 'http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac');\n\n        // Excel complains if specific elements on not in the correct order in the XML doc.\n        let promiseObj = { xml: wsXML, ws: ws };\n        _addSheetPr(promiseObj)\n        .then(_addDimension)\n        .then(_addSheetViews)\n        .then(_addSheetFormatPr)\n        .then(_addCols)\n        .then(_addSheetData)\n        .then(_addSheetProtection)\n        .then(_addAutoFilter)\n        .then(_addMergeCells)\n        .then(_addConditionalFormatting)\n        .then(_addDataValidations)\n        .then(_addHyperlinks)\n        .then(_addPrintOptions)\n        .then(_addPageMargins)\n        .then(_addPageSetup)\n        .then(_addHeaderFooter)\n        .then(_addDrawing)\n        .then((promiseObj) => {\n            let xmlString = promiseObj.xml.doc().end();\n            resolve(xmlString);\n        })\n        .catch((e) => {\n            console.error(e.stack);\n        });\n    });\n};\n\nlet relsXML = (ws) => {\n    return new Promise((resolve, reject) => {\n        let sheetRelRequired = false;\n        if (ws.relationships.length > 0) {\n            sheetRelRequired = true;\n        }\n\n        if (sheetRelRequired === false) {\n            resolve();\n        } \n\n        let relXML = xml.create(\n            'Relationships',\n            {\n                'version': '1.0', \n                'encoding': 'UTF-8', \n                'standalone': true\n            }\n        );\n        relXML.att('xmlns', 'http://schemas.openxmlformats.org/package/2006/relationships');\n\n        ws.relationships.forEach((r, i) => {\n            let rId = 'rId' + (i + 1);\n            if (r instanceof hyperlinks.Hyperlink) {\n                relXML.ele('Relationship')\n                .att('Id', rId)\n                .att('Target', r.location)\n                .att('TargetMode', 'External')\n                .att('Type', 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink');                \n            } else if (r === 'drawing') {\n                relXML.ele('Relationship')\n                .att('Id', rId)\n                .att('Target', '../drawings/drawing' + ws.sheetId + '.xml')\n                .att('Type', 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing');\n            }\n        });\n\n        let xmlString = relXML.doc().end();\n        resolve(xmlString);\n    });\n};\n\nmodule.exports = { sheetXML, relsXML };\n\n"]}
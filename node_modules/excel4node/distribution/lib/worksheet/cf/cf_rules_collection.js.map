{"version":3,"sources":["../../../../source/lib/worksheet/cf/cf_rules_collection.js"],"names":[],"mappings":";;;;;;AAAA,IAAM,SAAS,QAAQ,WAAR,CAAT;;;;IAIA;;;AACF,aADE,iBACF,GAAc;8BADZ,mBACY;;;AAEV,aAAK,YAAL,GAAoB,EAApB,CAFU;KAAd;;iBADE;;4BAUE,OAAO,YAAY;AACnB,gBAAI,QAAQ,KAAK,YAAL,CAAkB,KAAlB,KAA4B,EAA5B,CADO;AAEnB,gBAAI,UAAU,IAAI,MAAJ,CAAW,UAAX,CAAV,CAFe;AAGnB,kBAAM,IAAN,CAAW,OAAX,EAHmB;AAInB,iBAAK,YAAL,CAAkB,KAAlB,IAA2B,KAA3B,CAJmB;AAKnB,mBAAO,IAAP,CALmB;;;;oCAQX,KAAK;;;AACb,mBAAO,IAAP,CAAY,KAAK,YAAL,CAAZ,CAA+B,OAA/B,CAAuC,UAAC,KAAD,EAAW;AAC9C,oBAAI,UAAU,IAAI,GAAJ,CAAQ,uBAAR,EAAiC,GAAjC,CAAqC,OAArC,EAA8C,KAA9C,CAAV,CAD0C;AAE9C,sBAAK,YAAL,CAAkB,KAAlB,EAAyB,OAAzB,CAAiC,UAAC,IAAD,EAAU;AACvC,yBAAK,WAAL,CAAiB,OAAjB,EADuC;iBAAV,CAAjC,CAF8C;aAAX,CAAvC,CADa;;;;4BAZL;AACR,mBAAO,OAAO,IAAP,CAAY,KAAK,YAAL,CAAZ,CAA+B,MAA/B,CADC;;;;WANV;;;AA6BN,OAAO,OAAP,GAAiB,iBAAjB","file":"cf_rules_collection.js","sourcesContent":["const CfRule = require('./cf_rule');\n\n// -----------------------------------------------------------------------------\n\nclass CfRulesCollection { // ยง18.3.1.18 conditionalFormatting (Conditional Formatting)\n    constructor() {\n        // rules are indexed by cell refs\n        this.rulesBySqref = {};\n    }\n\n    get count() {\n        return Object.keys(this.rulesBySqref).length;\n    }\n\n    add(sqref, ruleConfig) {\n        let rules = this.rulesBySqref[sqref] || [];\n        let newRule = new CfRule(ruleConfig);\n        rules.push(newRule);\n        this.rulesBySqref[sqref] = rules;\n        return this;\n    }\n\n    addToXMLele(ele) {\n        Object.keys(this.rulesBySqref).forEach((sqref) => {\n            let thisEle = ele.ele('conditionalFormatting').att('sqref', sqref);\n            this.rulesBySqref[sqref].forEach((rule) => {\n                rule.addToXMLele(thisEle);\n            });\n        });\n    }\n}\n\n\nmodule.exports = CfRulesCollection;"]}